<!DOCTYPE html><html lang="ja">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>ãƒ†ã‚¹ãƒˆä¸€è¦§</title>
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/minecraft-font.css">
</head>
<body class="test-bg">
<div class="container" id="testList">
  <h2 style="margin-bottom:20px">ğŸ“ æ¼¢å­—èª­è§£ãƒ†ã‚¹ãƒˆä¸€è¦§</h2>
</div>

<script type="module">
import { getArchive, playClick } from './js/app.js';

const listElm = document.getElementById('testList');

/* tests.json ã¯ index.html ã¨åŒã˜éšå±¤ã«ç½®ãæƒ³å®š â†’ "./tests.json" */
fetch('./tests.json')
  .then(res => {
    if (!res.ok) throw new Error('tests.json ãŒèª­ã¿è¾¼ã‚ã¾ã›ã‚“');
    return res.json();
  })
  .then(data => {
    if (!data.tests || !data.tests.length) {
      listElm.innerHTML += '<p>ãƒ†ã‚¹ãƒˆãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>';
      return;
    }

    data.tests.forEach(test => {
      // ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–æ¸ˆã¿ã¯è¡¨ç¤ºã—ãªã„
      if (getArchive().includes(test.id)) return;

      const a = document.createElement('a');
      a.href = `single_test.html?id=${test.id}`;
      a.className = 'btn';
      a.textContent = `â–¶ ãƒ†ã‚¹ãƒˆ${test.id}`;
      a.addEventListener('click', playClick);
      listElm.appendChild(a);
    });

    /* ãƒ†ã‚¹ãƒˆãŒ 0 ä»¶ã—ã‹ãªã‘ã‚Œã°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
    if (listElm.querySelectorAll('.btn').length === 0) {
      listElm.innerHTML += '<p>è¡¨ç¤ºã§ãã‚‹ãƒ†ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>';
    }
  })
  .catch(err => {
    console.error(err);
    listElm.innerHTML += `<p style="color:red">${err.message}</p>`;
  });
</script>
</body></html>
